import{_ as o,c as s,o as n,aA as e,j as t,a as l}from"./chunks/framework.DInFk65k.js";const j=JSON.parse('{"title":"Internals: RBF Weight Building System","description":"","frontmatter":{},"headers":[],"relativePath":"reference/internals.md","filePath":"reference/internals.md","lastUpdated":null}'),r={name:"reference/internals.md"},i={class:"mjx-scroll-wrapper"},d={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},p={style:{"vertical-align":"-2.705ex"},xmlns:"http://www.w3.org/2000/svg",width:"22.969ex",height:"6.644ex",role:"img",focusable:"false",viewBox:"0 -1740.7 10152.1 2936.4"},C={class:"MathJax",jax:"SVG",overflow:"linebreak"},m={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.36ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1043 599.8"},c={class:"MathJax",jax:"SVG",overflow:"linebreak"},h={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.846ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1700 1000"},g={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.834ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1694.8 1000"},L={class:"mjx-scroll-wrapper"},x={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},u={style:{"vertical-align":"-2.243ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.641ex",height:"5.617ex",role:"img",focusable:"false",viewBox:"0 -1491.3 4261.1 2482.5"},b={class:"MathJax",jax:"SVG",overflow:"linebreak"},y={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.88ex",height:"1.552ex",role:"img",focusable:"false",viewBox:"0 -686 831 686"},_={class:"MathJax",jax:"SVG",overflow:"linebreak"},f={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.778ex",height:"1.552ex",role:"img",focusable:"false",viewBox:"0 -686 786 686"};function w(v,a,P,k,T,A){return n(),s("div",null,[a[14]||(a[14]=e(`<h1 id="Internals:-RBF-Weight-Building-System" tabindex="-1">Internals: RBF Weight Building System <a class="header-anchor" href="#Internals:-RBF-Weight-Building-System" aria-label="Permalink to &quot;Internals: RBF Weight Building System {#Internals:-RBF-Weight-Building-System}&quot;">​</a></h1><p>This document explains the architecture of the solve system, which builds sparse weight matrices for RBF operators. It is intended for developers who want to understand or extend the package.</p><h2 id="Call-Graph" tabindex="-1">Call Graph <a class="header-anchor" href="#Call-Graph" aria-label="Permalink to &quot;Call Graph {#Call-Graph}&quot;">​</a></h2><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>                      ┌─────────────────────────┐</span></span>
<span class="line"><span>                      │ User: construct operator│</span></span>
<span class="line"><span>                      └───────────┬─────────────┘</span></span>
<span class="line"><span>                                  │</span></span>
<span class="line"><span>                                  ▼</span></span>
<span class="line"><span>                      ┌───────────────────────────┐</span></span>
<span class="line"><span>                      │   _build_weights(L, op)   │</span></span>
<span class="line"><span>                      └───────────┬───────────────┘</span></span>
<span class="line"><span>                                  │</span></span>
<span class="line"><span>                                  ▼</span></span>
<span class="line"><span>                      ┌───────────────────────────┐</span></span>
<span class="line"><span>                      │ Apply L to basis/monomial │</span></span>
<span class="line"><span>                      └───────────┬───────────────┘</span></span>
<span class="line"><span>                                  │</span></span>
<span class="line"><span>                                  ▼</span></span>
<span class="line"><span>                ┌─────────────────────────────────────┐</span></span>
<span class="line"><span>                │        build_weights_kernel         │</span></span>
<span class="line"><span>                └──────┬─────────────────────┬────────┘</span></span>
<span class="line"><span>                       │                     │</span></span>
<span class="line"><span>                       ▼                     ▼</span></span>
<span class="line"><span>         ┌─────────────────────┐   ┌─────────────────┐</span></span>
<span class="line"><span>         │allocate_sparse_arrays│   │  launch_kernel! │</span></span>
<span class="line"><span>         └─────────────────────┘   └────────┬────────┘</span></span>
<span class="line"><span>                                            │</span></span>
<span class="line"><span>                                            ▼</span></span>
<span class="line"><span>                                 ┌──────────────────────┐</span></span>
<span class="line"><span>                                 │weight_kernel per batch│</span></span>
<span class="line"><span>                                 └──────────┬───────────┘</span></span>
<span class="line"><span>                                            │</span></span>
<span class="line"><span>                                            ▼</span></span>
<span class="line"><span>                                 ┌──────────────────────┐</span></span>
<span class="line"><span>                                 │   _build_stencil!    │</span></span>
<span class="line"><span>                                 └──┬───────┬───────┬───┘</span></span>
<span class="line"><span>                                    │       │       │</span></span>
<span class="line"><span>                     ┌──────────────┘       │       └──────────────┐</span></span>
<span class="line"><span>                     ▼                      ▼                      ▼</span></span>
<span class="line"><span>      ┌───────────────────────┐ ┌────────────────┐ ┌───────────────────┐</span></span>
<span class="line"><span>      │_build_collocation_    │ │  _build_rhs!   │ │    Solve A\\b      │</span></span>
<span class="line"><span>      │      matrix!          │ │                │ │                   │</span></span>
<span class="line"><span>      └───────────────────────┘ └────────────────┘ └───────────────────┘</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                                            │</span></span>
<span class="line"><span>                                            ▼</span></span>
<span class="line"><span>                                 ┌──────────────────────┐</span></span>
<span class="line"><span>                                 │sparse I,J,V -&gt; return│</span></span>
<span class="line"><span>                                 └──────────────────────┘</span></span></code></pre></div><h2 id="Architecture-Overview" tabindex="-1">Architecture Overview <a class="header-anchor" href="#Architecture-Overview" aria-label="Permalink to &quot;Architecture Overview {#Architecture-Overview}&quot;">​</a></h2><p>The solve system is organized into <strong>four layers</strong>, each with a clear responsibility:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>src/solve/</span></span>
<span class="line"><span>├── types.jl      # Layer 0: Shared data structures</span></span>
<span class="line"><span>├── assembly.jl   # Layer 1: Pure mathematical operations</span></span>
<span class="line"><span>├── execution.jl  # Layer 2: Parallel execution &amp; allocation</span></span>
<span class="line"><span>└── api.jl        # Layer 3: Entry points &amp; routing</span></span></code></pre></div><table tabindex="0"><thead><tr><th style="text-align:right;">Layer</th><th style="text-align:right;">File</th><th style="text-align:right;">Purpose</th></tr></thead><tbody><tr><td style="text-align:right;">3</td><td style="text-align:right;"><code>api.jl</code></td><td style="text-align:right;">Entry points from operators</td></tr><tr><td style="text-align:right;">2</td><td style="text-align:right;"><code>execution.jl</code></td><td style="text-align:right;">Memory allocation, parallel kernel execution, sparse matrix construction</td></tr><tr><td style="text-align:right;">1</td><td style="text-align:right;"><code>assembly.jl</code></td><td style="text-align:right;">Pure mathematics: collocation matrix, RHS, stencil assembly</td></tr><tr><td style="text-align:right;">0</td><td style="text-align:right;"><code>types.jl</code></td><td style="text-align:right;">Shared types and operator traits</td></tr></tbody></table><hr><h2 id="System-Flow" tabindex="-1">System Flow <a class="header-anchor" href="#System-Flow" aria-label="Permalink to &quot;System Flow {#System-Flow}&quot;">​</a></h2><p>The system builds sparse weight matrices by computing stencil weights in parallel for each evaluation point:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌───────────┐    ┌───────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌────────────────────┐    ┌──────────────┐</span></span>
<span class="line"><span>│ User Code │───&gt;│    api.jl     │───&gt;│  execution.jl   │───&gt;│   assembly.jl   │───&gt;│   execution.jl     │───&gt;│Return to user│</span></span>
<span class="line"><span>│           │    │ Route request │    │Allocate &amp; launch│    │Build A,b, solve │    │Construct sparse    │    │              │</span></span>
<span class="line"><span>│           │    │               │    │     kernel      │    │      A\\b        │    │      matrix        │    │              │</span></span>
<span class="line"><span>└───────────┘    └───────────────┘    └─────────────────┘    └─────────────────┘    └────────────────────┘    └──────────────┘</span></span></code></pre></div><p><strong>Key steps:</strong></p><ol><li><p><strong>Route</strong> — Operator calls <code>_build_weights</code>, which extracts data and applies the operator to the basis</p></li><li><p><strong>Allocate</strong> — Pre-allocate sparse arrays with exact non-zero counts (k entries per evaluation point)</p></li><li><p><strong>Build A</strong> — Construct the collocation matrix for each stencil&#39;s k-nearest neighbors</p></li><li><p><strong>Build b</strong> — Construct the RHS by applying the differential operator to the basis at the evaluation point</p></li><li><p><strong>Solve</strong> — Compute weights via <code>A \\ b</code></p></li><li><p><strong>Assemble</strong> — Pack weights into global sparse matrix</p></li></ol><hr><h2 id="Layer-Details" tabindex="-1">Layer Details <a class="header-anchor" href="#Layer-Details" aria-label="Permalink to &quot;Layer Details {#Layer-Details}&quot;">​</a></h2><h3 id="Layer-0:-types.jl-—-Data-Structures" tabindex="-1">Layer 0: <code>types.jl</code> — Data Structures <a class="header-anchor" href="#Layer-0:-types.jl-—-Data-Structures" aria-label="Permalink to &quot;Layer 0: \`types.jl\` — Data Structures {#Layer-0:-types.jl-—-Data-Structures}&quot;">​</a></h3><p>Defines shared types used throughout the solve system.</p><p><strong>Key types:</strong></p><ul><li><code>SingleOperator</code>, <code>MultiOperator{N}</code> — Operator arity traits for pre-allocating RHS buffers</li></ul><p><strong>When to modify:</strong> Adding new operator traits or shared data structures.</p><hr><h3 id="Layer-1:-assembly.jl-—-Pure-Mathematics" tabindex="-1">Layer 1: <code>assembly.jl</code> — Pure Mathematics <a class="header-anchor" href="#Layer-1:-assembly.jl-—-Pure-Mathematics" aria-label="Permalink to &quot;Layer 1: \`assembly.jl\` — Pure Mathematics {#Layer-1:-assembly.jl-—-Pure-Mathematics}&quot;">​</a></h3><p>Contains all mathematical operations for building stencils. <strong>No I/O, no parallelism</strong> — fully testable in isolation.</p><p><strong>Key functions:</strong></p><ul><li><p><code>_build_stencil!(A, b, ℒrbf, ℒmon, data, eval_point, basis, mon, k)</code> — Assembles and solves local system</p></li><li><p><code>_build_collocation_matrix!(A, data, basis, mon, k)</code> — Fills the collocation matrix</p></li><li><p><code>_build_rhs!(b, ℒrbf, ℒmon, data, eval_point, basis, k)</code> — Builds RHS vector</p></li></ul><p><strong>When to modify:</strong> Changing stencil mathematics or adding new RBF formulations.</p><hr><h3 id="Layer-2:-execution.jl-—-Parallel-Execution" tabindex="-1">Layer 2: <code>execution.jl</code> — Parallel Execution <a class="header-anchor" href="#Layer-2:-execution.jl-—-Parallel-Execution" aria-label="Permalink to &quot;Layer 2: \`execution.jl\` — Parallel Execution {#Layer-2:-execution.jl-—-Parallel-Execution}&quot;">​</a></h3><p>Handles memory management and parallel kernel execution via KernelAbstractions.jl.</p><p><strong>Key functions:</strong></p><ul><li><p><code>build_weights_kernel(...)</code> — Main orchestrator: allocates, launches kernel, returns sparse matrix</p></li><li><p><code>allocate_sparse_arrays(TD, k, N_eval, num_ops, adjl)</code> — Exact non-zero allocation</p></li><li><p><code>launch_kernel!(...)</code> — Dispatches parallel kernel over batches</p></li><li><p><code>@kernel weight_kernel(...)</code> — Per-batch kernel that builds weights for each evaluation point</p></li></ul><p><strong>When to modify:</strong> Improving parallelism, changing batch strategy, or optimizing memory allocation.</p><hr><h3 id="Layer-3:-api.jl-—-Entry-Points" tabindex="-1">Layer 3: <code>api.jl</code> — Entry Points <a class="header-anchor" href="#Layer-3:-api.jl-—-Entry-Points" aria-label="Permalink to &quot;Layer 3: \`api.jl\` — Entry Points {#Layer-3:-api.jl-—-Entry-Points}&quot;">​</a></h3><p>Public-facing entry points that operators call to build weights.</p><p><strong>Key functions:</strong></p><ul><li><p><code>_build_weights(ℒ, op)</code> — Entry from operator, extracts configuration</p></li><li><p><code>_build_weights(ℒ, data, eval_points, adjl, basis)</code> — Applies operator to basis</p></li><li><p><code>_build_weights(...; batch_size, device)</code> — Routes to kernel execution</p></li></ul><p><strong>When to modify:</strong> Adding new operator entry points or changing routing logic.</p><hr><h2 id="Key-Concepts" tabindex="-1">Key Concepts <a class="header-anchor" href="#Key-Concepts" aria-label="Permalink to &quot;Key Concepts {#Key-Concepts}&quot;">​</a></h2><h3 id="Stencils" tabindex="-1">Stencils <a class="header-anchor" href="#Stencils" aria-label="Permalink to &quot;Stencils {#Stencils}&quot;">​</a></h3><p>A <strong>stencil</strong> approximates a differential operator at a point using its k nearest neighbors:</p>`,43)),t("div",i,[t("mjx-container",d,[(n(),s("svg",p,[...a[0]||(a[0]=[e(`<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\mathcal{L}u(\\mathbf{x}_0) \\approx \\sum_{i=1}^{k} w_i \\cdot u(\\mathbf{x}_i)
"><g data-mml-node="TeXAtom" data-latex="\\mathcal{L}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="L"><path data-c="4C" d="M234 176C280 199 331 253 360 302C378 332 399 376 424 435C451 498 471 542 486 569C502 599 548 643 592 643C623 643 643 621 635 588C630 569 630 557 633 553C640 544 650 540 664 540L676 542C701 546 719 566 728 603C742 659 698 685 643 685C547 685 465 637 397 540C377 512 355 467 331 404C290 297 253 230 218 204C200 190 181 177 161 164C132 147 113 132 104 121C72 82 50 47 39 14L61-9C79 24 99 53 122 80C141 103 165 114 194 114C223 114 265 93 318 51C334 35 358 20 391 6C412-3 441-7 480-7C511-7 549 11 592 48C632 81 660 133 676 203C681 229 684 250 684 266L652 259C647 224 641 198 636 183C620 134 573 79 516 79C462 79 385 116 341 148C317 166 281 175 234 176Z"></path></g></g><g data-mml-node="mi" data-latex="u" transform="translate(770,0)"><path data-c="1D462" d="M543 144C543 153 538 158 527 158C518 158 513 151 510 137C505 118 500 99 493 80C480 39 462 18 440 18C422 18 413 32 413 60C413 77 420 111 433 161L460 267C469 303 477 328 483 359L489 386C491 393 492 398 492 401C492 421 481 431 459 431C437 431 423 419 417 394L343 98C342 95 338 88 330 76C314 50 275 18 235 18C197 18 178 44 178 95C178 136 196 202 231 294C242 324 248 345 248 357C248 407 213 442 163 442C118 442 83 417 58 367C39 328 29 301 29 287C29 278 34 273 45 273C58 273 60 279 64 293C87 373 119 413 160 413C174 413 181 403 181 384C181 369 175 348 164 319C126 218 107 148 107 111C107 34 155-11 232-11C275-11 314 9 347 50C361 9 391-11 437-11C506-11 527 70 543 144Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(1342,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="msub" data-latex="\\mathbf{x}_0" transform="translate(1731,0)"><g data-mml-node="TeXAtom" data-latex="\\mathbf{x}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="x"><path data-c="1D431" d="M585 0L585 47L514 47L346 246L463 376C476 390 482 397 565 397L565 444L473 441L370 444L370 397C384 397 396 395 408 388C404 382 404 380 400 376L316 282L218 397L258 397L258 444L137 441L27 444L27 397L98 397L254 213L123 66C106 47 70 47 22 47L22 0L114 3L217 0L217 47C199 47 180 52 180 58C180 58 180 60 187 68L284 177L394 47L355 47L355 0L475 3Z"></path></g></g><g data-mml-node="mn" transform="translate(640,-150) scale(0.707)" data-latex="0"><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z"></path></g></g><g data-mml-node="mo" data-latex=")" transform="translate(2774.6,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g><g data-mml-node="mo" data-latex="\\approx" transform="translate(3441.3,0)"><path data-c="2248" d="M717 432L717 434C717 445 712 450 701 450C694 450 689 446 686 439C679 404 665 377 645 360C612 331 577 317 539 317C510 317 480 328 449 349C392 390 358 413 347 420C304 445 266 457 232 457C125 457 77 382 56 284L56 281C56 271 61 266 72 266C81 266 86 270 88 278C95 313 108 339 128 356C161 385 196 399 235 399C264 399 293 388 324 366C381 326 415 303 426 296C469 271 507 259 541 259C648 259 696 334 717 432M717 216L717 219C717 229 712 234 701 234C694 234 689 230 686 223C679 188 665 162 645 144C612 115 577 101 539 101C510 101 480 112 449 134C392 174 358 197 347 204C304 229 266 241 232 241C125 241 77 166 56 68L56 66C56 55 61 50 72 50C81 50 86 54 88 62C95 97 108 123 128 140C161 169 196 183 235 183C264 183 293 172 324 151C381 110 415 87 426 80C469 55 507 43 541 43C648 43 696 118 717 216Z"></path></g><g data-mml-node="munderover" data-latex="\\sum_{i=1}^{k}" transform="translate(4492.1,0)"><g data-mml-node="mo" data-latex="\\sum"><path data-c="2211" d="M1265-450L1389-124L1355-124C1336-174 1304-216 1258-250C1145-334 1000-356 791-356L200-356L700 232C707 239 710 246 710 251L244 894L781 894C970 894 1127 870 1230 804C1290 766 1332 719 1356 663L1389 663L1265 950L88 950C70 950 60 947 57 941C56 938 56 926 56 905L581 187L68-415C61-423 57-430 57-435C57-445 67-450 88-450Z"></path></g><g data-mml-node="TeXAtom" transform="translate(148.2,-1087.9) scale(0.707)" data-latex="{i=1}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="i"><path data-c="1D456" d="M284 621C284 648 271 661 244 661C216 661 188 633 188 605C188 578 202 565 229 565C257 565 284 593 284 621M259 138C237 59 205 19 164 19C151 19 144 28 144 47C144 64 173 150 232 306C240 329 244 347 244 360C244 409 210 445 161 445C118 445 84 420 59 369C39 328 29 301 29 288C29 279 34 275 45 275C58 275 60 281 64 295C87 375 118 415 158 415C171 415 178 406 178 387C178 373 175 357 168 338C145 275 121 208 101 155C86 115 78 88 78 74C78 25 114-11 162-11C205-11 239 14 264 64C283 103 293 130 293 145C293 154 288 159 277 159C274 159 259 150 259 138Z"></path></g><g data-mml-node="mo" data-latex="=" transform="translate(345,0)"><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mn" data-latex="1" transform="translate(1123,0)"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(537.8,1150) scale(0.707)" data-latex="{k}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="k"><path data-c="1D458" d="M409 353C409 327 423 314 450 314C485 314 508 345 508 379C508 418 476 445 437 445C392 445 344 415 291 356C250 311 217 282 190 269L291 679C289 688 287 694 274 694C242 694 166 685 154 684C139 682 132 675 132 660C132 650 141 645 159 645C178 645 204 646 204 632L59 43C56 32 55 25 55 21C55 0 66-11 87-11C104-11 117-3 124 12C129 21 147 92 179 226C231 221 286 196 286 146C286 131 279 101 279 91C279 34 316-11 373-11C431-11 470 41 490 145C490 154 485 159 475 159C466 159 460 152 457 138C435 59 408 19 375 19C357 19 348 33 348 61C348 77 360 131 360 147C360 204 314 239 221 253C244 269 270 292 298 322C326 352 346 371 359 382C386 404 412 415 435 415C445 415 453 413 459 409C432 404 409 379 409 353Z"></path></g></g></g><g data-mml-node="msub" data-latex="w_i" transform="translate(6102.8,0)"><g data-mml-node="mi" data-latex="w"><path data-c="1D464" d="M590 391C590 382 595 372 606 362C629 340 641 313 641 281C641 264 635 237 623 198C586 78 539 18 482 18C435 18 412 45 412 100C412 119 416 142 423 171C441 243 460 314 477 387C479 394 480 398 480 401C480 421 469 431 447 431C427 431 414 421 407 401L367 245C352 187 341 167 341 115C341 107 341 101 342 98C319 45 290 18 255 18C205 18 180 47 180 104C180 141 197 204 231 293C242 323 248 344 248 357C248 406 212 442 163 442C118 442 84 417 59 367C39 328 29 301 29 287C29 278 34 273 45 273C58 273 60 279 64 293C88 373 120 413 160 413C174 413 181 403 181 384C181 369 175 347 164 317C127 220 108 154 108 117C108 32 165-11 252-11C294-11 328 10 355 53C375 10 416-11 479-11C541-11 590 30 625 112C648 164 691 302 691 369C691 384 690 394 689 399C685 418 666 442 644 442C618 442 590 417 590 391Z"></path></g><g data-mml-node="mi" transform="translate(749,-150) scale(0.707)" data-latex="i"><path data-c="1D456" d="M284 621C284 648 271 661 244 661C216 661 188 633 188 605C188 578 202 565 229 565C257 565 284 593 284 621M259 138C237 59 205 19 164 19C151 19 144 28 144 47C144 64 173 150 232 306C240 329 244 347 244 360C244 409 210 445 161 445C118 445 84 420 59 369C39 328 29 301 29 288C29 279 34 275 45 275C58 275 60 281 64 295C87 375 118 415 158 415C171 415 178 406 178 387C178 373 175 357 168 338C145 275 121 208 101 155C86 115 78 88 78 74C78 25 114-11 162-11C205-11 239 14 264 64C283 103 293 130 293 145C293 154 288 159 277 159C274 159 259 150 259 138Z"></path></g></g><g data-mml-node="mo" data-latex="\\cdot" transform="translate(7367.9,0)"><path data-c="22C5" d="M192 250C192 279 168 303 139 303C110 303 86 279 86 250C86 221 110 197 139 197C168 197 192 221 192 250Z"></path></g><g data-mml-node="mi" data-latex="u" transform="translate(7868.2,0)"><path data-c="1D462" d="M543 144C543 153 538 158 527 158C518 158 513 151 510 137C505 118 500 99 493 80C480 39 462 18 440 18C422 18 413 32 413 60C413 77 420 111 433 161L460 267C469 303 477 328 483 359L489 386C491 393 492 398 492 401C492 421 481 431 459 431C437 431 423 419 417 394L343 98C342 95 338 88 330 76C314 50 275 18 235 18C197 18 178 44 178 95C178 136 196 202 231 294C242 324 248 345 248 357C248 407 213 442 163 442C118 442 83 417 58 367C39 328 29 301 29 287C29 278 34 273 45 273C58 273 60 279 64 293C87 373 119 413 160 413C174 413 181 403 181 384C181 369 175 348 164 319C126 218 107 148 107 111C107 34 155-11 232-11C275-11 314 9 347 50C361 9 391-11 437-11C506-11 527 70 543 144Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(8440.2,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="msub" data-latex="\\mathbf{x}_i" transform="translate(8829.2,0)"><g data-mml-node="TeXAtom" data-latex="\\mathbf{x}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="x"><path data-c="1D431" d="M585 0L585 47L514 47L346 246L463 376C476 390 482 397 565 397L565 444L473 441L370 444L370 397C384 397 396 395 408 388C404 382 404 380 400 376L316 282L218 397L258 397L258 444L137 441L27 444L27 397L98 397L254 213L123 66C106 47 70 47 22 47L22 0L114 3L217 0L217 47C199 47 180 52 180 58C180 58 180 60 187 68L284 177L394 47L355 47L355 0L475 3Z"></path></g></g><g data-mml-node="mi" transform="translate(640,-150) scale(0.707)" data-latex="i"><path data-c="1D456" d="M284 621C284 648 271 661 244 661C216 661 188 633 188 605C188 578 202 565 229 565C257 565 284 593 284 621M259 138C237 59 205 19 164 19C151 19 144 28 144 47C144 64 173 150 232 306C240 329 244 347 244 360C244 409 210 445 161 445C118 445 84 420 59 369C39 328 29 301 29 288C29 279 34 275 45 275C58 275 60 281 64 295C87 375 118 415 158 415C171 415 178 406 178 387C178 373 175 357 168 338C145 275 121 208 101 155C86 115 78 88 78 74C78 25 114-11 162-11C205-11 239 14 264 64C283 103 293 130 293 145C293 154 288 159 277 159C274 159 259 150 259 138Z"></path></g></g><g data-mml-node="mo" data-latex=")" transform="translate(9763.1,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>`,1)])]))])]),t("p",null,[a[5]||(a[5]=l("The weights ",-1)),t("mjx-container",C,[(n(),s("svg",m,[...a[1]||(a[1]=[e('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="w_i"><g data-mml-node="msub" data-latex="w_i"><g data-mml-node="mi" data-latex="w"><path data-c="1D464" d="M590 391C590 382 595 372 606 362C629 340 641 313 641 281C641 264 635 237 623 198C586 78 539 18 482 18C435 18 412 45 412 100C412 119 416 142 423 171C441 243 460 314 477 387C479 394 480 398 480 401C480 421 469 431 447 431C427 431 414 421 407 401L367 245C352 187 341 167 341 115C341 107 341 101 342 98C319 45 290 18 255 18C205 18 180 47 180 104C180 141 197 204 231 293C242 323 248 344 248 357C248 406 212 442 163 442C118 442 84 417 59 367C39 328 29 301 29 287C29 278 34 273 45 273C58 273 60 279 64 293C88 373 120 413 160 413C174 413 181 403 181 384C181 369 175 347 164 317C127 220 108 154 108 117C108 32 165-11 252-11C294-11 328 10 355 53C375 10 416-11 479-11C541-11 590 30 625 112C648 164 691 302 691 369C691 384 690 394 689 399C685 418 666 442 644 442C618 442 590 417 590 391Z"></path></g><g data-mml-node="mi" transform="translate(749,-150) scale(0.707)" data-latex="i"><path data-c="1D456" d="M284 621C284 648 271 661 244 661C216 661 188 633 188 605C188 578 202 565 229 565C257 565 284 593 284 621M259 138C237 59 205 19 164 19C151 19 144 28 144 47C144 64 173 150 232 306C240 329 244 347 244 360C244 409 210 445 161 445C118 445 84 420 59 369C39 328 29 301 29 288C29 279 34 275 45 275C58 275 60 281 64 295C87 375 118 415 158 415C171 415 178 406 178 387C178 373 175 357 168 338C145 275 121 208 101 155C86 115 78 88 78 74C78 25 114-11 162-11C205-11 239 14 264 64C283 103 293 130 293 145C293 154 288 159 277 159C274 159 259 150 259 138Z"></path></g></g></g></g>',1)])]))]),a[6]||(a[6]=l(" are computed by solving the local collocation system ",-1)),t("mjx-container",c,[(n(),s("svg",h,[...a[2]||(a[2]=[e('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\mathbf{A}\\mathbf{w} = \\mathbf{b}"><g data-mml-node="TeXAtom" data-latex="\\mathbf{A}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="A"><path data-c="1D400" d="M827 0L827 47L730 47L474 672C463 698 451 698 434 698C406 698 402 690 395 672L147 70C141 55 138 47 62 47L41 47L41 0L158 3C197 3 253 3 290 0L290 47C290 47 201 47 201 60L205 72L255 193L523 193L583 47L488 47L488 0C526 3 621 3 664 3C704 3 792 3 827 0M503 240L275 240L389 518Z"></path></g></g><g data-mml-node="TeXAtom" data-latex="\\mathbf{w}" data-mjx-texclass="ORD" transform="translate(869,0)"><g data-mml-node="mi" data-latex="w"><path data-c="1D430" d="M805 397L805 444C782 442 752 441 728 441L632 444L632 397C641 397 690 396 690 385C690 382 687 376 686 373L581 117L467 397L523 397L523 444L409 441C367 441 325 443 309 444L309 397L368 397C389 347 389 344 389 344C389 340 386 334 385 331L306 139L201 397L257 397L257 444L134 441L25 444L25 397L84 397L237 23C244 6 248-4 273-4C298-4 302 6 309 23L415 282L521 23C528 6 532-4 557-4C582-4 586 6 593 23L737 376C742 389 746 397 805 397Z"></path></g></g></g></g>',1)])])),a[4]||(a[4]=t("mjx-break",{size:"4"}," ",-1)),(n(),s("svg",g,[...a[3]||(a[3]=[e('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\mathbf{A}\\mathbf{w} = \\mathbf{b}"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="TeXAtom" data-latex="\\mathbf{b}" data-mjx-texclass="ORD" transform="translate(1055.8,0)"><g data-mml-node="mi" data-latex="b"><path data-c="1D41B" d="M600 223C600 356 506 450 361 450C288 450 238 421 214 401L214 694L37 686L37 639C99 639 106 639 106 600L106 0L153 0C169 19 186 37 202 56C210 48 259-6 348-6C497-6 600 84 600 223M472 223C472 176 472 121 446 82C417 41 371 30 339 30C269 30 230 84 220 99L220 350C247 385 295 414 350 414C472 414 472 293 472 223Z"></path></g></g></g></g>',1)])]))]),a[7]||(a[7]=l(".",-1))]),a[15]||(a[15]=t("h3",{id:"Collocation-Matrix-Structure",tabindex:"-1"},[l("Collocation Matrix Structure "),t("a",{class:"header-anchor",href:"#Collocation-Matrix-Structure","aria-label":'Permalink to "Collocation Matrix Structure {#Collocation-Matrix-Structure}"'},"​")],-1)),a[16]||(a[16]=t("p",null,"The collocation matrix has a block structure:",-1)),t("div",L,[t("mjx-container",x,[(n(),s("svg",u,[...a[8]||(a[8]=[e(`<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\begin{bmatrix} \\mathbf{\\Phi} &amp; \\mathbf{P} \\\\ \\mathbf{P}^\\top &amp; \\mathbf{0} \\end{bmatrix}
"><g data-mml-node="mrow" data-latex="\\begin{bmatrix} \\mathbf{\\Phi} &amp; \\mathbf{P} \\\\ \\mathbf{P}^\\top &amp; \\mathbf{0} \\end{bmatrix}"><g data-mml-node="mo"><path data-c="5B" d="M477-884L297-884L297 1384L477 1384C498 1384 509 1395 509 1417C509 1439 498 1450 477 1450L233 1450L233-950L477-950C498-950 509-939 509-917C509-899 495-884 477-884Z"></path></g><g data-mml-node="mtable" transform="translate(528,0)"><g data-mml-node="mtr" transform="translate(0,741.3)"><g data-mml-node="mtd" transform="translate(294.1,0)"><g data-mml-node="TeXAtom" data-latex="\\mathbf{\\Phi}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="\\Phi"><path data-c="1D6BD" d="M766 343C766 392 732 514 475 534L475 639L610 639L610 686C566 683 459 683 410 683C361 683 253 683 209 686L209 639L344 639L344 533C188 523 64 450 64 343C64 236 188 163 344 153L344 47L209 47L209 0C253 3 360 3 409 3C458 3 566 3 610 0L610 47L475 47L475 152C734 172 766 296 766 343M344 190C219 208 211 286 211 343C211 401 219 478 344 496M619 343C619 270 602 204 475 189L475 497C602 482 619 416 619 343Z"></path></g></g></g><g data-mml-node="mtd" transform="translate(2419.1,0)"><g data-mml-node="TeXAtom" data-latex="\\mathbf{P}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="P"><path data-c="1D40F" d="M721 491C721 601 622 686 456 686L39 686L39 639L147 639L147 47L39 47L39 0C77 3 175 3 218 3C261 3 359 3 397 0L397 47L289 47L289 302L466 302C605 302 721 374 721 491M568 491C568 420 568 343 417 343L283 343L283 639L418 639C568 639 568 563 568 491Z"></path></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-741.3)"><g data-mml-node="mtd"><g data-mml-node="msup" data-latex="\\mathbf{P}^\\top"><g data-mml-node="TeXAtom" data-latex="\\mathbf{P}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="P"><path data-c="1D40F" d="M721 491C721 601 622 686 456 686L39 686L39 639L147 639L147 47L39 47L39 0C77 3 175 3 218 3C261 3 359 3 397 0L397 47L289 47L289 302L466 302C605 302 721 374 721 491M568 491C568 420 568 343 417 343L283 343L283 639L418 639C568 639 568 563 568 491Z"></path></g></g><g data-mml-node="mi" transform="translate(819,363) scale(0.707)" data-latex="\\top"><path data-c="22A4" d="M698 664L80 664C64 664 56 656 56 640C56 625 64 617 80 617L365 617L365 4C365-12 373-20 389-20C405-20 413-12 413 4L413 617L698 617C714 617 722 625 722 640C722 653 711 664 698 664Z"></path></g></g></g><g data-mml-node="mtd" transform="translate(2524.6,0)"><g data-mml-node="TeXAtom" data-latex="\\mathbf{0}" data-mjx-texclass="ORD"><g data-mml-node="mn" data-latex="0"><path data-c="1D7CE" d="M529 319C529 416 528 655 287 655C46 655 45 417 45 319C45 220 46-11 287-11C527-11 529 219 529 319M401 331C401 275 401 184 394 132C380 39 317 25 287 25C251 25 195 47 182 120C173 172 173 276 173 331C173 403 173 468 181 520C193 609 263 619 287 619C324 619 365 600 384 556C401 519 401 413 401 331Z"></path></g></g></g></g></g><g data-mml-node="mo" transform="translate(3733.1,0)"><path data-c="5D" d="M51-950L295-950L295 1450L51 1450C30 1450 19 1439 19 1417C19 1395 30 1384 51 1384L231 1384L231-884L51-884C30-884 19-895 19-917C19-939 30-950 51-950Z"></path></g></g></g></g>`,1)])]))])]),t("p",null,[a[11]||(a[11]=l("where ",-1)),t("mjx-container",b,[(n(),s("svg",y,[...a[9]||(a[9]=[e('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\mathbf{\\Phi}"><g data-mml-node="TeXAtom" data-latex="\\mathbf{\\Phi}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="\\Phi"><path data-c="1D6BD" d="M766 343C766 392 732 514 475 534L475 639L610 639L610 686C566 683 459 683 410 683C361 683 253 683 209 686L209 639L344 639L344 533C188 523 64 450 64 343C64 236 188 163 344 153L344 47L209 47L209 0C253 3 360 3 409 3C458 3 566 3 610 0L610 47L475 47L475 152C734 172 766 296 766 343M344 190C219 208 211 286 211 343C211 401 219 478 344 496M619 343C619 270 602 204 475 189L475 497C602 482 619 416 619 343Z"></path></g></g></g></g>',1)])]))]),a[12]||(a[12]=l(" is the RBF kernel matrix and ",-1)),t("mjx-container",_,[(n(),s("svg",f,[...a[10]||(a[10]=[e('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\mathbf{P}"><g data-mml-node="TeXAtom" data-latex="\\mathbf{P}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="P"><path data-c="1D40F" d="M721 491C721 601 622 686 456 686L39 686L39 639L147 639L147 47L39 47L39 0C77 3 175 3 218 3C261 3 359 3 397 0L397 47L289 47L289 302L466 302C605 302 721 374 721 491M568 491C568 420 568 343 417 343L283 343L283 639L418 639C568 639 568 563 568 491Z"></path></g></g></g></g>',1)])]))]),a[13]||(a[13]=l(" is the polynomial augmentation matrix. The system is solved to find weights that exactly reproduce polynomials up to the specified degree.",-1))]),a[17]||(a[17]=e('<hr><h2 id="Performance-Notes" tabindex="-1">Performance Notes <a class="header-anchor" href="#Performance-Notes" aria-label="Permalink to &quot;Performance Notes {#Performance-Notes}&quot;">​</a></h2><p><strong>Memory allocation:</strong></p><ul><li><p>Exact non-zero counting before allocation (k entries per evaluation point)</p></li><li><p>COO format construction with pre-computed row offsets</p></li></ul><p><strong>Parallelization:</strong></p><ul><li><p>Batch processing to control memory usage</p></li><li><p>Work arrays reused within each batch</p></li><li><p>KernelAbstractions.jl enables CPU/GPU execution</p></li></ul><hr><h2 id="Advanced:-Hermite-Interpolation" tabindex="-1">Advanced: Hermite Interpolation <a class="header-anchor" href="#Advanced:-Hermite-Interpolation" aria-label="Permalink to &quot;Advanced: Hermite Interpolation {#Advanced:-Hermite-Interpolation}&quot;">​</a></h2><p>For problems with boundary conditions, the package supports Hermite interpolation. This is triggered by providing boundary information (<code>is_boundary</code>, <code>boundary_conditions</code>, <code>normals</code>) to the operator constructor.</p><p>Hermite interpolation modifies the collocation matrix to incorporate boundary operators (Dirichlet, Neumann, Robin) at boundary nodes. This is an advanced feature primarily used for solving PDEs with explicit boundary conditions.</p><hr><h2 id="Navigation-Guide" tabindex="-1">Navigation Guide <a class="header-anchor" href="#Navigation-Guide" aria-label="Permalink to &quot;Navigation Guide {#Navigation-Guide}&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:right;">Want to...</th><th style="text-align:right;">Look in...</th></tr></thead><tbody><tr><td style="text-align:right;">Modify stencil mathematics</td><td style="text-align:right;"><code>assembly.jl</code></td></tr><tr><td style="text-align:right;">Improve parallelism or batching</td><td style="text-align:right;"><code>execution.jl</code></td></tr><tr><td style="text-align:right;">Add a new operator entry point</td><td style="text-align:right;"><code>api.jl</code></td></tr><tr><td style="text-align:right;">Understand sparse allocation</td><td style="text-align:right;"><code>execution.jl</code> → <code>allocate_sparse_arrays</code></td></tr><tr><td style="text-align:right;">Debug a specific stencil</td><td style="text-align:right;"><code>assembly.jl</code> → <code>_build_stencil!</code></td></tr></tbody></table>',13))])}const S=o(r,[["render",w]]);export{j as __pageData,S as default};
